	-- FUNCIONES 

DROP FUNCTION IF EXISTS APP_GYMBRO.ClienteConMayorReservas;

DELIMITER //

CREATE FUNCTION APP_GYMBRO.ClienteConMayorReservas(cliente varchar(50), reserva int)
RETURNS VARCHAR(100)
DETERMINISTIC
READS SQL DATA
BEGIN
    DECLARE clienteNombre VARCHAR(100);

    -- Consulta para encontrar el cliente con la mayor cantidad de reservas
    SELECT cliente.Nombre
    INTO clienteNombre
    FROM cliente
    JOIN (
        SELECT ID_Cliente
        FROM reserva
        GROUP BY ID_Cliente
        ORDER BY COUNT(*) DESC
        LIMIT 1
    ) r ON c.ID_Cliente = r.ID_Cliente;

    RETURN clienteNombre;
END //

DELIMITER ;
